<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Introdução e Erros - API OIIS</title>
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <main>
    <h1>Documentação da API OIIS</h1>

    <section id="introducao">
      <h2>Introdução</h2>
      <p>
        O <strong>OIIS - Owner Informatic Information System</strong> (nome do pacote: <code>com.oiis.server</code>, versão 3.0.0) é uma API RESTful desenvolvida para gerenciar informações empresariais de forma integrada, com suporte a autenticação segura, upload de arquivos, agendamento de tarefas, envio de emails, integração com mapas e transferência de arquivos via FTP. Construída com <strong>Node.js</strong>, <strong>Express</strong> e <strong>TypeScript</strong>, a API é altamente modular e escalável, com suporte a múltiplos bancos de dados e integrações externas.
      </p>
      <p>
        <strong>Base URL</strong>: <code>http://jumbo.brctec.com:3004</code><br>
        <strong>Repositório</strong>: <a href="https://github.com/aalencarvz1/oiis-server" target="_blank">github.com/aalencarvz1/oiis-server</a><br>
        <strong>Ponto de Entrada</strong>: <code>src/api/api.ts</code> (compilado para <code>dist/api/api.js</code>)
      </p>
      <h3>Tecnologias Utilizadas</h3>
      <ul>
        <li><strong>Node.js</strong>: Ambiente de execução (v18 ou superior).</li>
        <li><strong>Express</strong>: Framework web (v5.1.0).</li>
        <li><strong>TypeScript</strong>: Desenvolvimento tipado (v5.7.2).</li>
        <li><strong>MySQL e OracleDB</strong>: Bancos relacionais, gerenciados via Sequelize (v6.37.5).</li>
        <li><strong>JWT</strong>: Autenticação baseada em tokens (jsonwebtoken v9.0.2).</li>
        <li><strong>Bcrypt</strong>: Hashing de senhas (v5.1.1).</li>
        <li><strong>Multer</strong>: Upload de arquivos (v1.4.5).</li>
        <li><strong>Nodemailer</strong>: Envio de emails (v6.9.16).</li>
        <li><strong>Google Maps</strong>: Integração com APIs de mapas (v3.4.0).</li>
        <li><strong>Toad Scheduler</strong>: Agendamento de tarefas (v3.0.1).</li>
        <li><strong>Basic FTP</strong>: Transferência de arquivos (v5.0.5).</li>
        <li><strong>CORS</strong>: Suporte a requisições cross-origin (v2.8.5).</li>
        <li><strong>Compression</strong>: Compressão de respostas HTTP (v1.7.5).</li>
      </ul>
      <h3>Integrações</h3>
      <p>
        A API suporta integração com sistemas externos:
      </p>
      <ul>
        <li><strong>Winthor</strong>: Gerenciamento de produtos, clientes e filiais.</li>
        <li><strong>SJD</strong>: Dados de estoque, produtos e tabelas de preços.</li>
        <li><strong>EP</strong>: Clientes, vendas e movimentações.</li>
        <li><strong>RFB (Receita Federal)</strong>: Dados de empresas e estabelecimentos.</li>
      </ul>
      <h3>Configuração da API</h3>
      <p>
        A API é configurada com middlewares para otimizar desempenho, segurança e funcionalidade:
      </p>
      <ul>
        <li><strong>CORS</strong>: Permite requisições de origens diferentes.</li>
        <li><strong>Compression</strong>: Reduz o tamanho das respostas HTTP.</li>
        <li><strong>Body Parsing</strong>: Suporta JSON e URL-encoded com limite de 50MB.</li>
        <li><strong>Cookie Parser</strong>: Manipula cookies para autenticação (e.g., refresh tokens).</li>
        <li><strong>JWT Authentication</strong>: Verifica tokens em rotas protegidas, anexando <code>req.user</code>.</li>
        <li><strong>Custom Response</strong>: Respostas padronizadas no formato <code>{ success, message, data, exception }</code>.</li>
      </ul>
      <p>
        Arquivos estáticos são servidos em:
      </p>
      <ul>
        <li><code>/Uploads</code>: Arquivos enviados via endpoint de upload.</li>
        <li><code>/files</code>: Arquivos adicionais armazenados no servidor.</li>
      </p>
      <h3>Formato de Resposta</h3>
      <p>
        Todas as respostas seguem o formato:
      </p>
      <ul>
        <li><code>success</code>: Booleano indicando sucesso ou falha.</li>
        <li><code>message</code>: Mensagem descritiva (ou <code>null</code>).</li>
        <li><code>data</code>: Dados retornados (ou <code>null</code>).</li>
        <li><code>exception</code>: Detalhes de erro, se aplicável (ou <code>null</code>).</li>
      </ul>
      <p>
        Exemplo de sucesso (200):
      </p>
      <pre><code>
{
  "success": true,
  "message": "Operation successful",
  "data": {},
  "exception": null
}
      </code></pre>
      <p>
        Exemplo de erro (517):
      </p>
      <pre><code>
{
  "success": false,
  "message": "Internal server error",
  "data": null,
  "exception": "Error details"
}
      </code></pre>
      <h3>Endpoints</h3>
      <p>
        Endpoints são carregados dinamicamente de <code>src/controllers/</code> com prefixo <code>/api/controllers/</code>. Consulte as seções de controladores na navegação para detalhes.
      </p>
      <h3>Estrutura do Projeto</h3>
      <ul>
        <li><code>src/api/api.ts</code>: Ponto de entrada.</li>
        <li><code>src/api/api_schedulers.ts</code>: Tarefas agendadas.</li>
        <li><code>src/api/config.ts</code>: Configurações.</li>
        <li><code>src/controllers/</code>: Controladores (e.g., <code>AuthController</code>, <code>MidiasController</code>).</li>
        <li><code>src/database/</code>: Modelos Sequelize.</li>
        <li><code>src/utils/</code>: Utilitários (e.g., <code>Utils.ts</code>).</li>
        <li><code>src/types/</code>: Tipagem TypeScript.</li>
      </ul>
      <h3>Configuração e Execução</h3>
      <ol>
        <li>Clone o repositório: <code>git clone https://github.com/aalencarvz1/oiis-server.git</code></li>
        <li>Instale dependências: <code>npm install</code></li>
        <li>Configure <code>.env</code> com:
          <ul>
            <li><code>API_PORT=3004</code></li>
            <li><code>DB_*</code> (credenciais MySQL/OracleDB)</li>
            <li><code>API_SECRET</code>, <code>API_REFRESH_SECRET</code>, <code>API_RECOVER_SECRET</code></li>
            <li><code>API_EMAIL</code>, <code>API_EMAIL_PASSWORD</code></li>
          </ul>
        </li>
        <li>Crie pastas <code>Uploads/</code> e <code>files/</code>.</li>
        <li>Compile TypeScript: <code>npm run build</code></li>
        <li>Inicie a API: <code>npm start</code> ou <code>npm run dev</code></li>
        <li>Inicie agendadores (opcional): <code>npm run start:schedulers</code></li>
      </ol>
      <p>
        A API estará disponível em <code>http://jumbo.brctec.com:3004</code>.
      </p>
      <a href="#top" class="button">Voltar ao topo</a>
    </section>

    <section id="erros">
      <h2>Erros</h2>
      <p>
        A API retorna erros no formato padrão <code>{ success, message, data, exception }</code>. Códigos de status comuns incluem:
      </p>
      <ul>
        <li><strong>200</strong>: Sucesso.</li>
        <li><strong>401</strong>: Falha de autenticação (e.g., token inválido, usuário não encontrado).</li>
        <li><strong>517</strong>: Erro genérico do servidor.</li>
      </ul>
      <p>
        Exemplo de erro:
      </p>
      <pre><code>
{
  "success": false,
  "message": "Internal server error",
  "data": null,
  "exception": "Error details"
}
      </code></pre>
      <a href="#top" class="button">Voltar ao topo</a>
    </section>
  </main>
</body>
</html>